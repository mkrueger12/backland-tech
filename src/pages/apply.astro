---
import Layout from '../layouts/DefaultLayout.astro';
---

<Layout title="Apply - Join Our Talent Network">
  <main class="min-h-screen">
    <section class="mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8">
      <div class="mx-auto max-w-3xl text-center mb-12">
        <h1 class="text-4xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-5xl">
          <span class="text-gradient">Join The Backland Talent Network</span>
        </h1>
        <p class="mt-4 text-lg text-gray-600 dark:text-gray-300">
          Take the first step towards working on cutting-edge cybersecurity challenges.
        </p>
      </div>

      <div class="relative mx-auto max-w-4xl">
        <div class="form-container">
          <iframe
            data-tally-src="https://tally.so/embed/n964YY?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1"
            loading="lazy"
            width="100%"
            height="754"
            title="Apply to Join Talent Network"
            class="relative z-10"
          ></iframe>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .text-gradient {
    background: linear-gradient(315deg, var(--primary-200) 25%, var(--secondary-500));
    background-clip: border-box;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  :global(.darkmode) .text-gradient {
    background: linear-gradient(315deg, var(--primary-200) 25%, var(--secondary-400));
  }

  .form-container {
    position: relative;
    background: var(--gray-50);
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  :global(.darkmode) .form-container {
    background: var(--gray-900);
  }

  /* Remove frameborder attribute and handle it in CSS */
  iframe {
    border: none;
    margin: 0;
    padding: 0;
  }
</style>

<script>
  // Tally embed script
  declare global {
    interface Window {
      Tally?: any;
    }
  }

  const loadTallyEmbed = () => {
    const d = document;
    const w = "https://tally.so/widgets/embed.js";
    
    const v = () => {
      if (typeof window.Tally !== "undefined") {
        window.Tally.loadEmbeds();
      } else {
        d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach((e: HTMLIFrameElement) => {
          if (e.dataset.tallySrc) {
            e.src = e.dataset.tallySrc;
          }
        });
      }
    };

    if (typeof window.Tally !== "undefined") {
      v();
    } else if (d.querySelector(`script[src="${w}"]`) === null) {
      const s = d.createElement("script");
      s.src = w;
      s.onload = v;
      s.onerror = v;
      d.body.appendChild(s);
    }
  };

  // Run once the document is loaded
  document.addEventListener('DOMContentLoaded', loadTallyEmbed);

  // Also run when Astro swaps pages if using View Transitions
  document.addEventListener('astro:page-load', loadTallyEmbed);
</script>